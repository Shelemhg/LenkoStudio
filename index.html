<!doctype html>
	<html lang="en">
		<head>
			<meta charset="utf-8" />
			<meta name="viewport" content="width=device-width, initial-scale=1" />
			<link rel="icon" type="image/png" href="media/Logo.png" />
		<title>Lenko Studio — Cinematic Photo & Video</title>
		
		<!-- Google Fonts -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet" />
		
			<link rel="stylesheet" href="style.css" />
			<script src="js/components.js"></script>
			<meta name="description" content="Lenko Studio — Cinematic photo and video. Book a shoot, explore work, and discover ADAM for creators." />
		</head>
		<body class="stage-0">
			<div id="blackOverlay" class="overlay-black"></div>
			<a id="skipIntro" class="skip-link" href="#main">Skip intro</a>
			<site-header current="home"></site-header>

			<main id="main" class="home" role="main">
				<section class="hero" aria-label="Cinematic Intro">
					<div class="video-wrap" aria-hidden="true">
					<video id="bgVideo" muted playsinline loop preload="none"></video>
					<div class="scrim"></div>
					</div>
					<div id="gridOverlay" class="grid-overlay" aria-hidden="true"></div>

					<div class="hero-content">
						<h1 id="introTitle" class="intro-title" tabindex="0">Lenko Studio</h1>

						<div id="heroCtas" class="hero-ctas" aria-live="polite">
							<a class="cta" href="portfolio.html" id="ctaExplore">Explore Portfolio</a>
						</div>
					</div>
				</section>
				<a class="floating-cta" href="contact.html">Book a Shoot</a>
			</main>

			<footer class="site-footer" role="contentinfo">
			<div class="footer-inner">
				<p>© <span id="year"></span> Lenko Studio</p>
				
				<div class="social">
				<a href="https://www.instagram.com/lenkostudio/" target="_blank" rel="noopener">Instagram</a>
				<a href="https://www.facebook.com/LenkoStudio/" target="_blank" rel="noopener">Facebook</a>
				</div>
			</div>
			</footer>

			<audio id="ambientAudio" preload="none" loop>
			<source src="media/audio.mp3" type="audio/mpeg" />
			</audio>

			<script>
			(function () {
				const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
				const body = document.body;
				const bgVideo = document.getElementById('bgVideo');
				const title = document.getElementById('introTitle');
				const ctas = document.getElementById('heroCtas');
				const ambient = document.getElementById('ambientAudio');
				const blackOverlay = document.getElementById('blackOverlay');

				const LS_KEY = 'soundEnabled';
				
				// Check if sound was previously disabled
				const saved = localStorage.getItem(LS_KEY);
				const soundWasDisabled = saved === 'false';
				
				let stage = 0; // 0 = black, 1 = B&W animating, 2 = color + CTAs
				let completed = false;

				function track(name) {
					if (window.plausible) {
						try { window.plausible(name); } catch (e) {}
					} else {
						console.log('[analytics]', name);
					}
				}

				function setStage(next) {
					stage = next;
					body.classList.remove('stage-0', 'stage-1', 'stage-2');
					body.classList.add('stage-' + next);
					if (next === 2) {
						completed = true;
					}
				}

				function ensureVideoLoaded() {
					if (!bgVideo || bgVideo.dataset.loaded) return;
					const src = 'media/oceanvideo.mp4';
					const source = document.createElement('source');
					source.src = src;
					source.type = 'video/mp4';
					bgVideo.appendChild(source);
					bgVideo.dataset.loaded = '1';
					bgVideo.muted = true;
					const playPromise = bgVideo.play();
					if (playPromise && typeof playPromise.then === 'function') {
						playPromise.catch(() => {});
					}
				}

				function firstInteraction() {
					if (completed) return;
					if (stage === 0) {
						track('intro_click');
						setStage(2);
						ensureVideoLoaded();
						if (blackOverlay) blackOverlay.classList.add('is-hidden');
						// Start audio on first explicit click - only if user hasn't previously muted
						const wasMuted = localStorage.getItem(LS_KEY) === 'false';
						if (!wasMuted) {
							setSoundEnabled(true);
						}
					}
				}

				title.addEventListener('click', firstInteraction);
				title.addEventListener('touchstart', firstInteraction, { passive: false });
				title.addEventListener('keydown', (e) => {
					if (e.key === 'Enter' || e.key === ' ') {
						e.preventDefault();
						firstInteraction();
					}
				});
				document.addEventListener('click', (e) => {
					if (!e.target.closest('.hero-ctas')) firstInteraction();
				}, { capture: true });
				document.addEventListener('touchstart', (e) => {
					if (!e.target.closest('.hero-ctas')) firstInteraction();
				}, { capture: true, passive: false });

				// Skip intro entirely ONLY if sound was previously disabled
				if (soundWasDisabled) {
					setStage(2);
					if (blackOverlay) blackOverlay.classList.add('is-hidden');
					ensureVideoLoaded();
					track('intro_skip_sound_off');
				} else if (prefersReduced) {
					setStage(2);
					if (blackOverlay) blackOverlay.classList.add('is-hidden');
				} else {
					track('intro_load');
					if ('requestIdleCallback' in window) {
						window.requestIdleCallback(() => ensureVideoLoaded(), { timeout: 1500 });
					}
				}

				function updateSoundButton(enabled) {
					const btn = document.getElementById('soundToggle');
					if (!btn) return;
					const label = enabled ? 'Sound On' : 'Sound Off';
					btn.textContent = label;
					btn.setAttribute('aria-pressed', String(!!enabled));
					btn.setAttribute('aria-label', label);
				}

				function fadeVolume(target, ms = 400) {
					const start = ambient.volume;
					const steps = Math.max(1, Math.floor(ms / 50));
					let i = 0;
					const t = setInterval(() => {
						i++;
						const v = start + (target - start) * (i / steps);
						ambient.volume = Math.max(0, Math.min(1, v));
						if (i >= steps) {
							clearInterval(t);
							if (target === 0) ambient.pause();
						}
					}, 50);
				}

				function setSoundEnabled(enabled) {
					localStorage.setItem(LS_KEY, enabled ? 'true' : 'false');
					updateSoundButton(enabled);
					if (enabled) {
						try { ambient.play(); } catch (_) {}
						fadeVolume(1, 400);
						track('sound_toggle_on');
					} else {
						fadeVolume(0, 400);
						track('sound_toggle_off');
					}
				}

				const persisted = saved === null || saved === 'true';
				ambient.volume = 0;
				
				// Initialize button state and attach listener
				function initSoundButton() {
					const btn = document.getElementById('soundToggle');
					if (btn) {
						updateSoundButton(persisted);
						btn.addEventListener('click', () => {
							const enabled = btn.getAttribute('aria-pressed') !== 'true';
							setSoundEnabled(enabled);
						});
					} else {
						requestAnimationFrame(initSoundButton);
					}
				}
				initSoundButton();

				const ctaExplore = document.getElementById('ctaExplore');
				if (ctaExplore) ctaExplore.addEventListener('click', () => track('cta_explore_work'));

				const skipIntro = document.getElementById('skipIntro');
				if (skipIntro) skipIntro.addEventListener('click', () => { 
					if (blackOverlay) blackOverlay.classList.add('is-hidden'); 
					setStage(2); 
					setSoundEnabled(true); 
				});

				const y = document.getElementById('year');
				if (y) y.textContent = new Date().getFullYear();
				
				// Signal that index manages audio/toggle to avoid double-binding
				window.__audioControllerActive = true;
			})();
			</script>
			<script src="app.js"></script>
		</body>
	</html>
