/* ==========================================================================
   VISUAL: VIRAL LAB (A/B Testing & Science)
   ========================================================================== */

.visual-viral-lab {
    width: 100%;
    height: 100%;
    position: relative;
    overflow: hidden;
    background: #0f172a; /* Dark lab background */
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Background Grid */
.lab-grid-bg {
    position: absolute;
    inset: 0;
    background-image: 
        linear-gradient(rgba(56, 189, 248, 0.1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(56, 189, 248, 0.1) 1px, transparent 1px);
    background-size: 20px 20px;
    opacity: 0.5;
    animation: lab-grid-move 20s linear infinite;
}

/* Main Container */
.lab-container {
    position: relative;
    width: 80%;
    height: 60%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    z-index: 2;
}

/* Samples A and B */
.lab-sample {
    width: 60px;
    height: 80px;
    background: rgba(30, 41, 59, 0.8);
    border: 2px solid #475569;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    transition: all 0.5s ease;
}

.sample-label {
    font-size: 24px;
    font-weight: 800;
    color: #94a3b8;
    margin-bottom: 5px;
}

.sample-status {
    width: 40px;
    height: 4px;
    background: #475569;
    border-radius: 2px;
    transition: background 0.3s;
}

/* Winner Crown (Hidden by default) */
.winner-crown {
    position: absolute;
    top: -20px;
    font-size: 20px;
    opacity: 0;
    transform: translateY(10px);
}

/* Sample A Animation */
.sample-a {
    animation: sample-a-sequence 8s infinite cubic-bezier(0.4, 0, 0.2, 1);
}

/* Sample B Animation */
.sample-b {
    animation: sample-b-sequence 8s infinite cubic-bezier(0.4, 0, 0.2, 1);
}

/* Processor (Center) */
.lab-processor {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 40px;
    height: 40px;
}

.proc-core {
    width: 100%;
    height: 100%;
    background: #3b82f6;
    border-radius: 50%;
    box-shadow: 0 0 15px #3b82f6;
    animation: proc-pulse 2s infinite;
}

.proc-ring {
    position: absolute;
    inset: -10px;
    border: 2px dashed #60a5fa;
    border-radius: 50%;
    animation: proc-spin 4s linear infinite;
}

/* Scanning Beams */
.proc-beam-a, .proc-beam-b {
    position: absolute;
    top: 50%;
    height: 2px;
    background: #60a5fa;
    width: 0;
    transform-origin: center;
    opacity: 0;
}

.proc-beam-a {
    right: 50%; /* Shoots left */
    animation: beam-shoot-left 8s infinite linear;
}

.proc-beam-b {
    left: 50%; /* Shoots right */
    animation: beam-shoot-right 8s infinite linear;
}

/* Data Overlay */
.lab-data-overlay {
    position: absolute;
    bottom: 10px;
    left: 10px;
    right: 10px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    z-index: 1;
}

.data-row {
    height: 2px;
    background: linear-gradient(90deg, transparent, #3b82f6, transparent);
    width: 100%;
    opacity: 0;
    transform: translateX(-100%);
    animation: data-stream 3s infinite linear;
}

.data-row:nth-child(2) { animation-delay: 0.5s; }
.data-row:nth-child(3) { animation-delay: 1.0s; }


/* ==========================================================================
   ANIMATIONS
   ========================================================================== */

@keyframes lab-grid-move {
    0% { background-position: 0 0; }
    100% { background-position: 20px 20px; }
}

@keyframes proc-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

@keyframes proc-pulse {
    0%, 100% { transform: scale(1); opacity: 0.8; }
    50% { transform: scale(1.1); opacity: 1; box-shadow: 0 0 25px #3b82f6; }
}

/* Sequence: 
   0-10%: Idle
   10-30%: Analyzing (Beams)
   30-40%: Processing
   40-80%: Result (A Fails, B Wins)
   80-100%: Reset
*/

@keyframes beam-shoot-left {
    0%, 10% { width: 0; opacity: 0; }
    15% { width: 60px; opacity: 1; } /* Connect to A */
    30% { width: 60px; opacity: 1; }
    35% { width: 0; opacity: 0; } /* Retract */
    100% { width: 0; opacity: 0; }
}

@keyframes beam-shoot-right {
    0%, 10% { width: 0; opacity: 0; }
    15% { width: 60px; opacity: 1; } /* Connect to B */
    30% { width: 60px; opacity: 1; }
    35% { width: 0; opacity: 0; } /* Retract */
    100% { width: 0; opacity: 0; }
}

@keyframes sample-a-sequence {
    0%, 35% { transform: scale(1); border-color: #475569; opacity: 1; }
    
    /* FAILURE STATE */
    40% { transform: scale(0.9); border-color: #ef4444; background: rgba(239, 68, 68, 0.1); }
    45% { transform: scale(0.9) rotate(-3deg); } /* Shake/Wilt */
    75% { transform: scale(0.9); opacity: 0.5; }
    
    85% { transform: scale(1); border-color: #475569; background: rgba(30, 41, 59, 0.8); opacity: 1; }
}

@keyframes sample-b-sequence {
    0%, 35% { transform: scale(1); border-color: #475569; }
    
    /* SUCCESS STATE */
    40% { transform: scale(1.1); border-color: #10b981; background: rgba(16, 185, 129, 0.1); box-shadow: 0 0 20px rgba(16, 185, 129, 0.2); }
    45% { transform: scale(1.15); }
    50% { transform: scale(1.1); }
    
    /* Crown Appear */
    
    85% { transform: scale(1); border-color: #475569; background: rgba(30, 41, 59, 0.8); box-shadow: none; }
}

@keyframes data-stream {
    0% { transform: translateX(-100%); opacity: 0; }
    50% { opacity: 1; }
    100% { transform: translateX(100%); opacity: 0; }
}

/* Specific styling for internal elements during state changes would use child selectors or separate logic, 
   but since we can't keyframe child properties easily without complex selectors, we used generic transforms above. 
   We will update the status bar color via separate keyframes if needed, but the border color change on parent is good. 
*/
